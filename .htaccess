AddDefaultCharset UTF-8
ServerSignature Off
Options -Indexes -MultiViews +FollowSymLinks
RewriteOptions InheritDownBefore
<IfModule mod_headers.c>
    Header always unset Server
    Header always unset Link
    Header always unset X-Powered-By
    Header always unset X-Pingback
    Header always unset Link
    Header always set X-Content-Type-Options "nosniff"
</IfModule>
<IfModule mod_rewrite.c>
    RewriteEngine On

    # разрешаем .well-known для получения сертификата
    RewriteRule ^\.well-known/ - [L,NC]

    # скрываем все что начинается с точки (site.ru/.env site.ru/page/.git/history/)
    RewriteRule (^|/)\. - [R=404,L]

    # скрываем с пустым user agent
    RewriteCond %{HTTP_USER_AGENT} ^(-)?$
    RewriteRule .* - [F,L]

    # скрываем по имени директории
    RewriteRule ^.*/(upgrade|backup|backups|vendor|node_modules|logs|tmp|temp|bin)/.* - [R=404,L,NC]

    # скрываем по имени файла
    RewriteRule ^(.*/)?(config\.js|composer\.json|package\.json|package-lock\.json|phpunit\.xml|phpcs\.xml|phpmd\.xml|Dockerfile|Makefile|LICENSE|wp-config-sample\.php|wp-config\.php|xmlrpc\.php|readme\.html|readme\.txt|changelog\.txt|wp-cron\.php)$ - [R=404,L,NC]

    # скрываем шаблоны blade
    RewriteRule (^|/).*\.blade\.php$ - [R=404,L,NC]

    # скрываем по расширению файла
    RewriteRule \.(pot|cache|pem|key|crt|csr|p12|pfx|~|temp|tmp|save|orig|back|bak|backup|old|swp|swo|swn|dump|db|sqlite|sqlite3|ini|phps|fla|psd|log|sh|lock|md|sql|tpl|twig|bat|ps|example|yaml|yml|config|conf)$ - [R=404,L,NC]

    # скрываем по имени директории с php
    RewriteRule ^.*/(uploads|cache|plugins|mu-plugins)/.*\.php$ - [R=404,L,NC]

    # скрываем для user agents
    RewriteCond %{HTTP_USER_AGENT} "offline|ahrefs|backlinks|barkrowler|blex|curl|dataforseo|dotbot|geedo|gigaexplorator|httrack|keys|mj12|seekport|semrush|seranking|teleport|terracotta|timpibot|trendictionbot|webcopier|webzip|wget|wpbot|bytespider|petalbot|baidu|oai-searchbot|meta-externalagent|wpscan" [NC]
    RewriteRule .* - [R=404,L]
</IfModule>